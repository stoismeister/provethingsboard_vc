{
  "entityType" : "WIDGETS_BUNDLE",
  "entity" : {
    "alias" : "bundle_di_test",
    "description" : null,
    "externalId" : null,
    "id" : {
      "entityType" : "WIDGETS_BUNDLE",
      "id" : "4bff12b0-7c7c-11ed-a76d-9955dd563d2d"
    },
    "image" : null,
    "title" : "bundle di test"
  },
  "widgets" : [ {
    "alias" : "basic_timeseries",
    "name" : "Timeseries with CSV download",
    "image" : "data:image/png;base64,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",
    "description" : "Displays changes to timeseries data over time, with possibility to export data in CSV format",
    "descriptor" : {
      "type" : "timeseries",
      "sizeX" : 8,
      "sizeY" : 5,
      "resources" : [ ],
      "templateHtml" : "",
      "templateCss" : ".legend {\n    font-size: 13px;\n    line-height: 10px;\n}\n\n.legend table { \n    border-spacing: 0px;\n    border-collapse: separate;\n}\n\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n",
      "controllerScript" : "self.onInit = function() {\n    self.ctx.flot = new TbFlot(self.ctx);    \n}\n\nself.onDataUpdated = function() {\n    self.ctx.flot.update();\n}\n\nself.onLatestDataUpdated = function() {\n    self.ctx.flot.latestDataUpdate();\n}\n\nself.onResize = function() {\n    self.ctx.flot.resize();\n}\n\nself.onEditModeChanged = function() {\n    self.ctx.flot.checkMouseEvents();\n}\n\nself.onDestroy = function() {\n    self.ctx.flot.destroy();\n}\n\nself.typeParameters = function() {\n    return {\n        hasAdditionalLatestDataKeys: true\n    };\n}\n",
      "settingsSchema" : "{}",
      "dataKeySettingsSchema" : "{}",
      "latestDataKeySettingsSchema" : "{}",
      "settingsDirective" : "tb-flot-line-widget-settings",
      "dataKeySettingsDirective" : "tb-flot-line-key-settings",
      "latestDataKeySettingsDirective" : "tb-flot-latest-key-settings",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1},\"legend\":{\"show\":true,\"position\":\"nw\",\"backgroundColor\":\"#f0f0f0\",\"backgroundOpacity\":0.85,\"labelBoxBorderColor\":\"rgba(1, 1, 1, 0.45)\"},\"decimals\":1,\"stack\":false,\"tooltipIndividual\":false},\"title\":\"Timeseries with CSV download\",\"dropShadow\":true,\"enableFullscreen\":false,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null,\"actions\":{\"headerButton\":[{\"name\":\"download csv\",\"icon\":\"file_download\",\"useShowWidgetActionFunction\":null,\"showWidgetActionFunction\":\"return true;\",\"type\":\"customPretty\",\"customHtml\":\"<form #addEntityForm=\\\"ngForm\\\" [formGroup]=\\\"addEntityFormGroup\\\"\\n      (ngSubmit)=\\\"save()\\\" class=\\\"add-entity-form\\\">\\n    <mat-toolbar fxLayout=\\\"row\\\" color=\\\"primary\\\">\\n        <h2>Scarica CSV</h2>\\n        <span fxFlex></span>\\n        <button mat-icon-button (click)=\\\"cancel()\\\" type=\\\"button\\\">\\n            <mat-icon class=\\\"material-icons\\\">close</mat-icon>\\n        </button>\\n    </mat-toolbar>\\n\\n    <div mat-dialog-content fxLayout=\\\"column\\\">\\n        <div fxLayout=\\\"row\\\" fxLayoutGap=\\\"8px\\\" fxLayout.xs=\\\"column\\\"  fxLayoutGap.xs=\\\"0\\\">\\n            <mat-form-field fxFlex class=\\\"mat-block\\\">\\n                <mat-label>Numero elementi</mat-label>\\n                <input matInput formControlName=\\\"elementNumber\\\" type=\\\"number\\\" (change)=\\\"elementNumber()\\\" [(ngModel)]=\\\"myValue\\\">\\n                    <mat-error *ngIf=\\\"addEntityFormGroup.get('attributes.elementNumber').hasError('pattern')\\\">\\n                        Invalid integer value.\\n                    </mat-error>\\n                    <mat-hint>Default value: 100</mat-hint>\\n            </mat-form-field>\\n        </div>\\n    </div>\\n  \\n    <div mat-dialog-actions fxLayout=\\\"row\\\" fxLayoutAlign=\\\"end center\\\">\\n        <button mat-button color=\\\"primary\\\"\\n                type=\\\"button\\\"\\n                [disabled]=\\\"false\\\"\\n                (click)=\\\"cancel()\\\" cdkFocusInitial>\\n            Annulla\\n        </button>\\n        <button mat-button mat-raised-button color=\\\"primary\\\"\\n                type=\\\"submit\\\"\\n                [disabled]=\\\"false\\\"\\n                (click)=\\\"download()\\\" cdkFocusInitial>\\n            Scarica\\n        </button>\\n    </div>\\n</form>\\n\",\"customCss\":\"\\n.add-entity-form .boolean-value-input {\\n    padding-left: 5px;\\n}\\n\\n.add-entity-form .boolean-value-input .checkbox-label {\\n    margin-bottom: 8px;\\n    color: rgba(0,0,0,0.54);\\n    font-size: 12px;\\n}\\n\\n.relations-list .header {\\n    padding-right: 5px;\\n    padding-bottom: 5px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .header .cell {\\n    padding-right: 5px;\\n    padding-left: 5px;\\n    font-size: 12px;\\n    font-weight: 700;\\n    color: rgba(0, 0, 0, .54);\\n    white-space: nowrap;\\n}\\n\\n.relations-list .mat-form-field-infix {\\n    width: auto !important;\\n}\\n\\n.relations-list .body {\\n    padding-right: 5px;\\n    padding-bottom: 15px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .body .row {\\n    padding-top: 5px;\\n}\\n\\n.relations-list .body .cell {\\n    padding-right: 5px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .body .md-button {\\n    margin: 0;\\n}\\n\\n\",\"customFunction\":\"\\nlet $injector = widgetContext.$scope.$injector;\\n\\nvar fileOutput=\\\"\\\";\\nvar keys=[];\\nvar starTs;\\nvar endTs;\\nvar dataKeysDevice=[];\\nvar element=100;\\n\\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\\n\\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\\nlet entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\\n\\n\\nopenAddEntityDialog();\\n\\nfunction openAddEntityDialog() {\\n    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\\n}\\n\\nfunction AddEntityDialogController(instance) {\\n    let vm = instance;\\n\\n    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\\n    vm.entitySearchDirection = {\\n        from: \\\"FROM\\\",\\n        to: \\\"TO\\\"\\n    }\\n\\n    vm.dataKeyType = \\\"timeseries\\\"\\n    \\n    vm.addEntityFormGroup = vm.fb.group({\\n        elementNumber: [null, [vm.validators.pattern(/^-?[0-9]+$/)]], \\n        entityName: ['', [vm.validators.required]],\\n      entityType: ['DEVICE'],\\n      entityLabel: [null],\\n      type: ['', [vm.validators.required]],\\n      attributes: vm.fb.group({\\n          latitude: [null],\\n          longitude: [null],\\n          address: [null],\\n          owner: [null],\\n          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\\n          elementNumber: [null, [vm.validators.pattern(/^-?[0-9]+$/)]], \\n          booleanValue: [null]\\n      }),\\n    });\\n\\n    vm.starTs=widgetContext.timeWindow.minTime;\\n    vm.endTs=widgetContext.timeWindow.maxTime;\\n    vm.numberRow=element;\\n    vm.keys=widgetContext.datasources[0];\\n\\tvm.file=fileOutput;\\n\\t\\n\\tgetEntityInfo();\\n\\t\\n\\tfunction getEntityInfo() {\\n\\t    starTs=widgetContext.timeWindow.minTime;\\n        endTs=widgetContext.timeWindow.maxTime;\\n        var numberRow=element;\\n        keys=widgetContext.datasources[0];\\n        \\n        for(let i=0; i<keys.dataKeys.length;i++){\\n            let key=keys.dataKeys[i].name;\\n            dataKeysDevice[i] = key\\n        }\\n    \\n          widgetContext.rxjs.forkJoin([\\n             \\n        //     //getEntityTimeseries(entityId: EntityId, keys: Array<string>, startTs: number, endTs: number, limit: number, agg: Aggregation Type, interval: number, orderBy: Data Sort Order, useStrictDataTypes: boolean, config?: RequestConfig): Observable<Timeseries Data>\\n        //     //export enum AggregationType {\\n        //     //   MIN = 'MIN',\\n        //     //   MAX = 'MAX',\\n        //     //   AVG = 'AVG',\\n        //     //   SUM = 'SUM',\\n        //     //   COUNT = 'COUNT',\\n        //     //   NONE = 'NONE'\\n        //     // }\\n            \\n        //     // export enum DataSortOrder {\\n        //     //     ASC = 'ASC',\\n        //     //     DESC = 'DESC'\\n        //     // }\\n            //  attributeService.getEntityTimeseries(entityId, dataKeysDevice, starTs, endTs, element)\\n            attributeService.getEntityTimeseries(entityId, dataKeysDevice, starTs, endTs, element, 'NONE', 0, 'ASC', false)\\n          ]).subscribe(\\n              function (data) {\\n               \\n               var parts = \\\"device;key; ts; value\\\\n\\\";\\n\\n                if(data.length > 0){\\n                     for(let i=0; i<data.length;i++){\\n                        let current=data[i];\\n                        \\n                      \\n                         Object.keys(current).forEach( key => {\\n                            current[key].forEach (element => {\\n                                 parts +=entityName+ \\\";\\\" +  key + \\\";\\\" + element.ts.toString() + \\\";\\\" + element.value + \\\"\\\\n\\\"\\n                            })\\n                        })\\n                    \\n                     }\\n                }\\n                fileOutput=parts;\\n        \\t\\tvm.file=fileOutput;\\n                    \\n              }\\n             );\\n\\t} \\n\\t\\n    vm.elementNumber = function() {\\n        if(vm.myValue && vm.myValue>0 ){\\n            vm.numberRow=vm.myValue;\\n        }else{\\n            vm.numberRow=100;\\n        }\\n\\t\\t\\n \\t\\tgetEntityInfoValue();\\n    };\\n    \\n \\tfunction getEntityInfoValue() {\\n      \\n        var starTs=vm.starTs;\\n        var endTs=vm.endTs;\\n        var keys=vm.keys;\\n\\t\\tvar element=vm.numberRow;\\t\\t       \\n\\t    var dataKeysDevice=[];\\n\\n        for(let i=0; i<keys.dataKeys.length;i++){\\n            let key=keys.dataKeys[i].name;\\n            dataKeysDevice[i] = key\\n        }  \\n\\n        \\n          widgetContext.rxjs.forkJoin([\\n             \\n        //     //getEntityTimeseries(entityId: EntityId, keys: Array<string>, startTs: number, endTs: number, limit: number, agg: Aggregation Type, interval: number, orderBy: Data Sort Order, useStrictDataTypes: boolean, config?: RequestConfig): Observable<Timeseries Data>\\n        //     //export enum AggregationType {\\n        //     //   MIN = 'MIN',\\n        //     //   MAX = 'MAX',\\n        //     //   AVG = 'AVG',\\n        //     //   SUM = 'SUM',\\n        //     //   COUNT = 'COUNT',\\n        //     //   NONE = 'NONE'\\n        //     // }\\n            \\n        //     // export enum DataSortOrder {\\n        //     //     ASC = 'ASC',\\n        //     //     DESC = 'DESC'\\n        //     // }\\n             attributeService.getEntityTimeseries(entityId, dataKeysDevice, starTs, endTs, element)\\n          ]).subscribe(\\n              function (data) {\\n                   var parts = \\\"device;key; ts; value\\\\n\\\";\\n                    if(data.length > 0){\\n                     for(let i=0; i<data.length;i++){\\n                        let current=data[i];\\n                        \\n                      \\n                         Object.keys(current).forEach( key => {\\n                            current[key].forEach (element => {\\n                                 parts +=entityName+ \\\";\\\" +  key + \\\";\\\" + element.ts.toString() + \\\";\\\" + element.value + \\\"\\\\n\\\"\\n                            })\\n                        })\\n                    \\n                     }\\n                }\\n                    fileOutput=parts;\\n            \\t\\tvm.file=fileOutput;\\n             \\n              }\\n             );\\n    \\n    }\\n    \\n    vm.download=function() {\\n       downloadFile('timeseries.csv', 'data:text/csv;charset=UTF-8,' + encodeURIComponent(fileOutput));\\n   }\\n   \\n    function downloadFile(fileName, urlData) {\\n        var aLink = document.createElement('a');\\n        var evt = document.createEvent(\\\"HTMLEvents\\\");\\n        evt.initEvent(\\\"click\\\");\\n        aLink.download = fileName;\\n        aLink.href = urlData;\\n        aLink.dispatchEvent(evt);\\n        aLink.click();\\n        vm.dialogRef.close(null);\\n    } \\n    \\n        vm.save = function() {\\n        vm.addEntityFormGroup.markAsPristine();\\n        widgetContext.rxjs.forkJoin([\\n            \\n        ]).subscribe(\\n            function () {\\n                vm.dialogRef.close(null);\\n            }\\n        );\\n    };\\n\\n    vm.cancel = function() {\\n        vm.dialogRef.close(null);\\n    };\\n}\\n\",\"customResources\":[],\"openInSeparateDialog\":false,\"openInPopover\":false,\"id\":\"bf221294-d4f3-bdb0-9439-4b2b42834d34\"}]},\"showTitleIcon\":false,\"titleTooltip\":\"\",\"widgetStyle\":{},\"widgetCss\":\"\",\"pageSize\":1024,\"noDataDisplayMessage\":\"\",\"showLegend\":false,\"legendConfig\":{\"direction\":\"column\",\"position\":\"bottom\",\"sortDataKeys\":false,\"showMin\":false,\"showMax\":false,\"showAvg\":true,\"showTotal\":false,\"showLatest\":false}}"
    },
    "bundleAlias" : "bundle_di_test",
    "createdTime" : 1671111310986,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "4c382ea0-7c7d-11ed-a76d-9955dd563d2d"
    },
    "tenantId" : {
      "entityType" : "TENANT",
      "id" : "64ee8810-2de8-11ed-9397-cd2dc17441ed"
    }
  }, {
    "alias" : "timeseries_chart2",
    "name" : "Grafico Consumi",
    "image" : null,
    "description" : null,
    "descriptor" : {
      "type" : "timeseries",
      "sizeX" : 11.5,
      "sizeY" : 5.5,
      "resources" : [ ],
      "templateHtml" : "",
      "templateCss" : ".legend {\n    font-size: 13px;\n    line-height: 10px;\n}\n\n.legend table { \n    border-spacing: 0px;\n    border-collapse: separate;\n}\n\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n",
      "controllerScript" : "self.onInit = function() {\n    self.ctx.flot = new TbFlot(self.ctx);    \n}\n\nself.onDataUpdated = function() {\n    self.ctx.flot.update();\n}\n\nself.onResize = function() {\n    self.ctx.flot.resize();\n}\n\nself.onEditModeChanged = function() {\n    self.ctx.flot.checkMouseEvents();\n}\n\nself.onMobileModeChanged = function() {\n    self.ctx.flot.checkMouseEvents();\n}\n\n//self.getSettingsSchema = function() {\n//    return TbFlot.settingsSchema('graph');\n//}\n\n//self.getDataKeySettingsSchema = function() {\n//    return TbFlot.datakeySettingsSchema(true);\n//}\n\nself.onDestroy = function() {\n    self.ctx.flot.destroy();\n}\n",
      "settingsSchema" : "  {}",
      "dataKeySettingsSchema" : "{}",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"capacity\",\"color\":\"#42a5f5\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false,\"showPointsRadius\":3,\"axisPosition\":\"left\",\"showSeparateAxis\":true},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"interval\":1800000,\"timewindowMs\":604800000},\"aggregation\":{\"type\":\"AVG\",\"limit\":25000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgb(0, 58, 93)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\",\"min\":0},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":false,\"horizontalLines\":false,\"outlineWidth\":1},\"stack\":false,\"tooltipIndividual\":false,\"timeForComparison\":\"months\",\"xaxisSecond\":{\"axisPosition\":\"top\",\"showLabels\":true}},\"title\":\"Grafico Consumi\",\"dropShadow\":true,\"enableFullscreen\":false,\"titleStyle\":{\"fontSize\":\"18px\",\"fontWeight\":400},\"mobileHeight\":null,\"showTitleIcon\":false,\"titleIcon\":\"more_horiz\",\"iconColor\":\"rgba(0, 0, 0, 0.87)\",\"iconSize\":\"24px\",\"titleTooltip\":\"\",\"widgetStyle\":{},\"useDashboardTimewindow\":true,\"displayTimewindow\":true,\"showLegend\":false,\"actions\":{\"headerButton\":[{\"id\":\"cdfa9456-cd7c-770c-5c7b-fb64f52fa824\",\"name\":\"Download CSV\",\"icon\":\"file_download\",\"type\":\"customPretty\",\"customHtml\":\"<md-dialog aria-label=\\\"Scarica csv\\\">\\r\\n    <form name=\\\"addEntityForm\\\" class=\\\"add-entity-form\\\" ng-submit=\\\"vm.save()\\\">\\r\\n        <md-toolbar>\\r\\n            <div class=\\\"md-toolbar-tools\\\">\\r\\n                <h2>Scarica CSV</h2>\\r\\n                <span flex></span>\\r\\n                <md-button class=\\\"md-icon-button\\\" ng-click=\\\"vm.cancel()\\\">\\r\\n                    <ng-md-icon icon=\\\"close\\\" aria-label=\\\"Close\\\"></ng-md-icon>\\r\\n                </md-button>\\r\\n            </div>\\r\\n        </md-toolbar>\\r\\n        <md-content class=\\\"md-padding\\\" layout=\\\"column\\\">\\r\\n            <md-input-container>\\r\\n              <label>Numero elementi</label>  \\r\\n              <input  name=\\\"elementNumber\\\" type=\\\"number\\\" ng-change=\\\"vm.elementNumber()\\\" ng-model=\\\"myValue\\\"/>\\r\\n              <div ng-messages=\\\"rpcForm.rpcMethod.$error\\\">\\r\\n              </div>\\r\\n            </md-input-container>  \\r\\n        </md-content>\\r\\n        <md-dialog-actions>\\r\\n            <md-button  ng-click=\\\"vm.download()\\\"  class=\\\"md-raised md-primary\\\">Scarica</md-button>\\r\\n            <md-button ng-click=\\\"vm.cancel()\\\" class=\\\"md-primary\\\">Annulla</md-button>\\r\\n        </md-dialog-actions>\\r\\n    </form>\\r\\n</md-dialog>\",\"customCss\":\".add-entity-form md-input-container {\\r\\n    padding-right: 10px;\\r\\n}\\r\\n\\r\\n.add-entity-form .boolean-value-input {\\r\\n    padding-left: 5px;\\r\\n}\\r\\n\\r\\n.add-entity-form .boolean-value-input .checkbox-label {\\r\\n    margin-bottom: 8px;\\r\\n    color: rgba(0,0,0,0.54);\\r\\n    font-size: 12px;\\r\\n}\\r\\n\\r\\n.relations-list .header {\\r\\n    padding-right: 5px;\\r\\n    padding-bottom: 5px;\\r\\n    padding-left: 5px;\\r\\n}\\r\\n\\r\\n.relations-list .header .cell {\\r\\n    padding-right: 5px;\\r\\n    padding-left: 5px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 700;\\r\\n    color: rgba(0, 0, 0, .54);\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n.relations-list .body {\\r\\n    padding-right: 5px;\\r\\n    padding-bottom: 15px;\\r\\n    padding-left: 5px;\\r\\n}\\r\\n\\r\\n.relations-list .body .row {\\r\\n    padding-top: 5px;\\r\\n}\\r\\n\\r\\n.relations-list .body .cell {\\r\\n    padding-right: 5px;\\r\\n    padding-left: 5px;\\r\\n}\\r\\n\\r\\n.relations-list .body md-autocomplete-wrap md-input-container {\\r\\n    height: 30px;\\r\\n}\\r\\n\\r\\n.relations-list .body .md-button {\\r\\n    margin: 0;\\r\\n}\\r\\n\\r\\n\",\"customFunction\":\"var $injector = widgetContext.$scope.$injector;\\r\\nvar fileOutput=\\\"\\\";\\r\\nvar keys=[];\\r\\nvar starTs;\\r\\nvar endTs;\\r\\nvar dataKeysDevice=\\\"\\\";\\r\\nvar element=100;\\r\\n\\r\\nvar $mdDialog = $injector.get('$mdDialog'),\\r\\n    $document = $injector.get('$document'),\\r\\n    $q = $injector.get('$q'),\\r\\n    $rootScope = $injector.get('$rootScope'),\\r\\n    types = $injector.get('types'),\\r\\n    assetService = $injector.get('assetService'),\\r\\n    deviceService = $injector.get('deviceService'),\\r\\n    attributeService = $injector.get('attributeService'),\\r\\n    entityRelationService = $injector.get('entityRelationService');\\r\\n    \\r\\n\\r\\nopenAddEntityDialog();\\r\\n\\r\\nfunction openAddEntityDialog() {\\r\\n    $mdDialog.show({\\r\\n        controller: ['$scope','$mdDialog', AddEntityDialogController],\\r\\n        controllerAs: 'vm',\\r\\n        template: htmlTemplate,\\r\\n        locals: {\\r\\n            entityId: entityId\\r\\n        },\\r\\n        parent: angular.element($document[0].body),\\r\\n        targetEvent: $event,\\r\\n        multiple: true,\\r\\n        clickOutsideToClose: false\\r\\n    });\\r\\n\\r\\n}\\r\\n\\r\\nfunction AddEntityDialogController($scope, $mdDialog) {\\r\\n    var vm = this;\\r\\n    vm.allowedEntityTypes = [types.entityType.asset, types.entityType.device];\\r\\n    vm.allowedRelatedEntityTypes = [];\\r\\n    vm.entitySearchDirection = types.entitySearchDirection;\\r\\n    vm.dataKeyType=types.dataKeyType.timeseries;\\r\\n    vm.attributes = {};\\r\\n    vm.relations = [];\\r\\n    vm.entries =[];\\r\\n    vm.deviceEntries ={};\\r\\n    vm.entityId = entityId;\\r\\n    vm.entityName = entityName;\\r\\n    vm.entityType = entityId.entityType;\\r\\n    vm.serverAttributes = {};\\r\\n    vm.newRelations = [];\\r\\n    vm.relationsToDelete = [];\\r\\n   \\r\\n    vm.starTs=widgetContext.timeWindow.minTime;\\r\\n    vm.endTs=widgetContext.timeWindow.maxTime;\\r\\n    vm.numberRow=element;\\r\\n    vm.keys=widgetContext.datasources[0];\\r\\n\\tvm.file=fileOutput;\\r\\n    \\r\\n\\tgetEntityInfo();\\r\\n\\t\\r\\n    \\r\\n    vm.save = function() {\\r\\n        $scope.addEntityForm.$setPristine();\\r\\n        saveEntityPromise().then(\\r\\n            function (entity) {\\r\\n                $mdDialog.hide();\\r\\n            }\\r\\n        );\\r\\n        \\r\\n        \\r\\n    };\\r\\n    function getEntityInfo() {\\r\\n      \\r\\n        starTs=widgetContext.timeWindow.minTime;\\r\\n        endTs=widgetContext.timeWindow.maxTime;\\r\\n        var numberRow=element;\\r\\n        keys=widgetContext.datasources[0];\\r\\n        \\r\\n        \\r\\n        for(var i=0; i<keys.dataKeys.length;i++){\\r\\n            var key=keys.dataKeys[i].name;\\r\\n            dataKeysDevice+=key+\\\",\\\";\\r\\n            \\r\\n        }   \\r\\n        \\r\\n        dataKeysDevice=dataKeysDevice.substring(0, dataKeysDevice.length - 1);\\r\\n        \\r\\n        attributeService.getEntityTimeseriesValues(\\r\\n               entityId.entityType, entityId.id,dataKeysDevice, starTs, endTs, element).then\\r\\n                    (response =>{ \\r\\n                        parseValues(response);\\r\\n                      \\r\\n                    })\\r\\n    \\r\\n        }\\r\\n\\r\\n\\r\\n  \\r\\n    function parseValues(timeseries){\\r\\n        \\r\\n        var parts = \\\"device;key; ts; value\\\\n\\\";\\r\\n    \\r\\n        Object.keys(timeseries).forEach( key => {\\r\\n        \\r\\n            timeseries[key].forEach (element => {\\r\\n                 parts +=entityName+ \\\";\\\" +  key + \\\";\\\" + element.ts.toString() + \\\";\\\" + element.value + \\\"\\\\n\\\"\\r\\n            \\r\\n            })\\r\\n        })\\r\\n        \\r\\n        fileOutput=parts;\\r\\n\\t\\tvm.file=fileOutput;\\r\\n      \\r\\n    }\\r\\n\\r\\n    \\r\\n    vm.cancel = function() {\\r\\n        $mdDialog.hide();\\r\\n    };\\r\\n   \\r\\n   vm.elementNumber = function() {\\r\\n        if($scope.myValue && $scope.myValue>0 ){\\r\\n            vm.numberRow=$scope.myValue;\\r\\n        }else{\\r\\n            vm.numberRow=100;\\r\\n        }\\r\\n\\t\\t\\r\\n\\t\\tgetEntityInfoValue();\\r\\n    };\\r\\n    \\r\\n   vm.download=function() {\\r\\n       downloadFile('timeseries.csv', 'data:text/csv;charset=UTF-8,' + encodeURIComponent(fileOutput));\\r\\n   }\\r\\n   \\r\\n    function downloadFile(fileName, urlData) {\\r\\n        var aLink = document.createElement('a');\\r\\n        var evt = document.createEvent(\\\"HTMLEvents\\\");\\r\\n        evt.initEvent(\\\"click\\\");\\r\\n        aLink.download = fileName;\\r\\n        aLink.href = urlData;\\r\\n        aLink.dispatchEvent(evt);\\r\\n        aLink.click();\\r\\n         $mdDialog.hide();\\r\\n    }  \\r\\n    \\r\\n\\tfunction getEntityInfoValue() {\\r\\n      \\r\\n        var starTs=vm.starTs;\\r\\n        var endTs=vm.endTs;\\r\\n        var keys=vm.keys;\\r\\n\\t\\tvar element=vm.numberRow;\\t\\t       \\r\\n\\t    var dataKeysDevice=\\\"\\\";\\r\\n\\r\\n        for(var i=0; i<keys.dataKeys.length;i++){\\r\\n            var key=keys.dataKeys[i].name;\\r\\n            dataKeysDevice+=key+\\\",\\\";\\r\\n            \\r\\n        }   \\r\\n        \\r\\n        dataKeysDevice=dataKeysDevice.substring(0, dataKeysDevice.length - 1);\\r\\n        \\r\\n        attributeService.getEntityTimeseriesValues(\\r\\n               entityId.entityType, entityId.id,dataKeysDevice, starTs, endTs, element).then\\r\\n                    (response =>{ \\r\\n                        parseValues(response);\\r\\n                      \\r\\n                    })\\r\\n    \\r\\n        }\\r\\n}\"}]}}"
    },
    "bundleAlias" : "bundle_di_test",
    "createdTime" : 1671110912629,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "5ec7ba50-7c7c-11ed-a76d-9955dd563d2d"
    },
    "tenantId" : {
      "entityType" : "TENANT",
      "id" : "64ee8810-2de8-11ed-9397-cd2dc17441ed"
    }
  }, {
    "alias" : "timeseries_table2",
    "name" : "Timeseries table csv",
    "image" : "data:image/png;base64,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",
    "description" : "Displays time series data for one or more entities. Data for each entity is displayed in a separate tab.",
    "descriptor" : {
      "type" : "timeseries",
      "sizeX" : 8,
      "sizeY" : 6.5,
      "resources" : [ ],
      "templateHtml" : "<tb-timeseries-table-widget \n    [ctx]=\"ctx\">\n</tb-timeseries-table-widget>",
      "templateCss" : "",
      "controllerScript" : "self.onInit = function() {\n}\n\nself.onDataUpdated = function() {\n     self.ctx.$scope.timeseriesTableWidget.onDataUpdated();\n}\n\nself.onLatestDataUpdated = function() {\n     self.ctx.$scope.timeseriesTableWidget.onLatestDataUpdated();\n}\n\nself.typeParameters = function() {\n    return {\n        ignoreDataUpdateOnIntervalTick: true,\n        hasAdditionalLatestDataKeys: true\n    };\n}\n\nself.actionSources = function() {\n    return {\n        'actionCellButton': {\n            name: 'widget-action.action-cell-button',\n            multiple: true,\n            hasShowCondition: true\n        },\n        'rowClick': {\n            name: 'widget-action.row-click',\n            multiple: false\n        }\n    };\n}\n\nself.onDestroy = function() {\n}\n",
      "settingsSchema" : "",
      "dataKeySettingsSchema" : "",
      "latestDataKeySettingsSchema" : "",
      "settingsDirective" : "tb-timeseries-table-widget-settings",
      "dataKeySettingsDirective" : "tb-timeseries-table-key-settings",
      "latestDataKeySettingsDirective" : "tb-timeseries-table-latest-key-settings",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Temperature  Â°C\",\"color\":\"#2196f3\",\"settings\":{\"useCellStyleFunction\":true,\"cellStyleFunction\":\"if (value) {\\n    var percent = (value + 60)/120 * 100;\\n    var color = tinycolor.mix('blue', 'red', percent);\\n    color.setAlpha(.5);\\n    return {\\n      paddingLeft: '20px',\\n      color: '#ffffff',\\n      background: color.toRgbString(),\\n      fontSize: '18px'\\n    };\\n} else {\\n    return {};\\n}\",\"useCellContentFunction\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 40 - 20;\\nvar multiplier = Math.pow(10, 1 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -60) {\\n\\tvalue = -60;\\n} else if (value > 60) {\\n\\tvalue = 60;\\n}\\nreturn value;\",\"units\":null,\"decimals\":null,\"usePostProcessing\":null,\"postFuncBody\":null},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Humidity, %\",\"color\":\"#ffc107\",\"settings\":{\"useCellStyleFunction\":true,\"cellStyleFunction\":\"if (value) {\\n    var percent = value;\\n    var backgroundColor = tinycolor('blue');\\n    backgroundColor.setAlpha(value/100);\\n    var color = 'blue';\\n    if (value > 50) {\\n        color = 'white';\\n    }\\n    \\n    return {\\n      paddingLeft: '20px',\\n      color: color,\\n      background: backgroundColor.toRgbString(),\\n      fontSize: '18px'\\n    };\\n} else {\\n    return {};\\n}\",\"useCellContentFunction\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 20 - 10;\\nvar multiplier = Math.pow(10, 1 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < 5) {\\n\\tvalue = 5;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value;\"}],\"latestDataKeys\":null}],\"timewindow\":{\"realtime\":{\"interval\":1000,\"timewindowMs\":60000},\"aggregation\":{\"type\":\"NONE\",\"limit\":200}},\"showTitle\":true,\"backgroundColor\":\"rgb(255, 255, 255)\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"showTimestamp\":true,\"displayPagination\":true,\"defaultPageSize\":10},\"title\":\"Timeseries table csv\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400,\"padding\":\"5px 10px 5px 10px\"},\"useDashboardTimewindow\":false,\"showLegend\":false,\"widgetStyle\":{},\"actions\":{\"headerButton\":[{\"name\":\"Download CSV\",\"icon\":\"file_download\",\"useShowWidgetActionFunction\":null,\"showWidgetActionFunction\":\"return true;\",\"type\":\"customPretty\",\"customHtml\":\"<form #addEntityForm=\\\"ngForm\\\" [formGroup]=\\\"addEntityFormGroup\\\"\\n      (ngSubmit)=\\\"save()\\\" class=\\\"add-entity-form\\\">\\n    <mat-toolbar fxLayout=\\\"row\\\" color=\\\"primary\\\">\\n        <h2>Scarica CSV</h2>\\n        <span fxFlex></span>\\n        <button mat-icon-button (click)=\\\"cancel()\\\" type=\\\"button\\\">\\n            <mat-icon class=\\\"material-icons\\\">close</mat-icon>\\n        </button>\\n    </mat-toolbar>\\n\\n    <div mat-dialog-content fxLayout=\\\"column\\\">\\n        <div fxLayout=\\\"row\\\" fxLayoutGap=\\\"8px\\\" fxLayout.xs=\\\"column\\\"  fxLayoutGap.xs=\\\"0\\\">\\n            <mat-form-field fxFlex class=\\\"mat-block\\\">\\n                <mat-label>Numero elementi</mat-label>\\n                <input matInput formControlName=\\\"elementNumber\\\" type=\\\"number\\\" (change)=\\\"elementNumber()\\\" [(ngModel)]=\\\"myValue\\\">\\n                    <mat-error *ngIf=\\\"addEntityFormGroup.get('attributes.elementNumber').hasError('pattern')\\\">\\n                        Invalid integer value.\\n                    </mat-error>\\n                    <mat-hint>Default value: 100</mat-hint>\\n            </mat-form-field>\\n        </div>\\n    </div>\\n  \\n    <div mat-dialog-actions fxLayout=\\\"row\\\" fxLayoutAlign=\\\"end center\\\">\\n        <button mat-button color=\\\"primary\\\"\\n                type=\\\"button\\\"\\n                [disabled]=\\\"false\\\"\\n                (click)=\\\"cancel()\\\" cdkFocusInitial>\\n            Annulla\\n        </button>\\n        <button mat-button mat-raised-button color=\\\"primary\\\"\\n                type=\\\"submit\\\"\\n                [disabled]=\\\"false\\\"\\n                (click)=\\\"download()\\\" cdkFocusInitial>\\n            Scarica\\n        </button>\\n    </div>\\n</form>\",\"customCss\":\"/*=======================================================================*/\\n/*==========  There are two examples: for edit and add entity  ==========*/\\n/*=======================================================================*/\\n/*========================  Edit entity example  ========================*/\\n/*=======================================================================*/\\n/*\\n.edit-entity-form .boolean-value-input {\\n    padding-left: 5px;\\n}\\n\\n.edit-entity-form .boolean-value-input .checkbox-label {\\n    margin-bottom: 8px;\\n    color: rgba(0,0,0,0.54);\\n    font-size: 12px;\\n}\\n\\n.relations-list .header {\\n    padding-right: 5px;\\n    padding-bottom: 5px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .header .cell {\\n    padding-right: 5px;\\n    padding-left: 5px;\\n    font-size: 12px;\\n    font-weight: 700;\\n    color: rgba(0, 0, 0, .54);\\n    white-space: nowrap;\\n}\\n\\n.relations-list .mat-form-field-infix {\\n    width: auto !important;\\n}\\n\\n.relations-list .body {\\n    padding-right: 5px;\\n    padding-bottom: 15px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .body .row {\\n    padding-top: 5px;\\n}\\n\\n.relations-list .body .cell {\\n    padding-right: 5px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .body .md-button {\\n    margin: 0;\\n}\\n*/\\n/*========================================================================*/\\n/*=========================  Add entity example  =========================*/\\n/*========================================================================*/\\n/*\\n.add-entity-form .boolean-value-input {\\n    padding-left: 5px;\\n}\\n\\n.add-entity-form .boolean-value-input .checkbox-label {\\n    margin-bottom: 8px;\\n    color: rgba(0,0,0,0.54);\\n    font-size: 12px;\\n}\\n\\n.relations-list .header {\\n    padding-right: 5px;\\n    padding-bottom: 5px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .header .cell {\\n    padding-right: 5px;\\n    padding-left: 5px;\\n    font-size: 12px;\\n    font-weight: 700;\\n    color: rgba(0, 0, 0, .54);\\n    white-space: nowrap;\\n}\\n\\n.relations-list .mat-form-field-infix {\\n    width: auto !important;\\n}\\n\\n.relations-list .body {\\n    padding-right: 5px;\\n    padding-bottom: 15px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .body .row {\\n    padding-top: 5px;\\n}\\n\\n.relations-list .body .cell {\\n    padding-right: 5px;\\n    padding-left: 5px;\\n}\\n\\n.relations-list .body .md-button {\\n    margin: 0;\\n}\\n*/\\n\",\"customFunction\":\"\\nlet $injector = widgetContext.$scope.$injector;\\n\\nvar fileOutput=\\\"\\\";\\nvar keys=[];\\nvar starTs;\\nvar endTs;\\nvar dataKeysDevice=[];\\nvar element=100;\\n\\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\\n\\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\\nlet entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\\n\\n\\nopenAddEntityDialog();\\n\\nfunction openAddEntityDialog() {\\n    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\\n}\\n\\nfunction AddEntityDialogController(instance) {\\n    let vm = instance;\\n\\n    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\\n    vm.entitySearchDirection = {\\n        from: \\\"FROM\\\",\\n        to: \\\"TO\\\"\\n    }\\n\\n    vm.dataKeyType = \\\"timeseries\\\"\\n    \\n    vm.addEntityFormGroup = vm.fb.group({\\n        elementNumber: [null, [vm.validators.pattern(/^-?[0-9]+$/)]], \\n        entityName: ['', [vm.validators.required]],\\n      entityType: ['DEVICE'],\\n      entityLabel: [null],\\n      type: ['', [vm.validators.required]],\\n      attributes: vm.fb.group({\\n          latitude: [null],\\n          longitude: [null],\\n          address: [null],\\n          owner: [null],\\n          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\\n          elementNumber: [null, [vm.validators.pattern(/^-?[0-9]+$/)]], \\n          booleanValue: [null]\\n      }),\\n    });\\n\\n    vm.starTs=widgetContext.timeWindow.minTime;\\n    vm.endTs=widgetContext.timeWindow.maxTime;\\n    vm.numberRow=element;\\n    vm.keys=widgetContext.datasources[0];\\n\\tvm.file=fileOutput;\\n\\t\\n\\tgetEntityInfo();\\n\\t\\n\\tfunction getEntityInfo() {\\n\\t    starTs=widgetContext.timeWindow.minTime;\\n        endTs=widgetContext.timeWindow.maxTime;\\n        var numberRow=element;\\n        keys=widgetContext.datasources[0];\\n        \\n        for(let i=0; i<keys.dataKeys.length;i++){\\n            let key=keys.dataKeys[i].name;\\n            dataKeysDevice[i] = key\\n        }\\n    \\n          widgetContext.rxjs.forkJoin([\\n             \\n        //     //getEntityTimeseries(entityId: EntityId, keys: Array<string>, startTs: number, endTs: number, limit: number, agg: Aggregation Type, interval: number, orderBy: Data Sort Order, useStrictDataTypes: boolean, config?: RequestConfig): Observable<Timeseries Data>\\n        //     //export enum AggregationType {\\n        //     //   MIN = 'MIN',\\n        //     //   MAX = 'MAX',\\n        //     //   AVG = 'AVG',\\n        //     //   SUM = 'SUM',\\n        //     //   COUNT = 'COUNT',\\n        //     //   NONE = 'NONE'\\n        //     // }\\n            \\n        //     // export enum DataSortOrder {\\n        //     //     ASC = 'ASC',\\n        //     //     DESC = 'DESC'\\n        //     // }\\n            //  attributeService.getEntityTimeseries(entityId, dataKeysDevice, starTs, endTs, element)\\n            attributeService.getEntityTimeseries(entityId, dataKeysDevice, starTs, endTs, element, 'NONE', 0, 'ASC', false)\\n          ]).subscribe(\\n              function (data) {\\n               \\n               var parts = \\\"device;key; ts; value\\\\n\\\";\\n\\n                if(data.length > 0){\\n                     for(let i=0; i<data.length;i++){\\n                        let current=data[i];\\n                        \\n                      \\n                         Object.keys(current).forEach( key => {\\n                            current[key].forEach (element => {\\n                                 parts +=entityName+ \\\";\\\" +  key + \\\";\\\" + element.ts.toString() + \\\";\\\" + element.value + \\\"\\\\n\\\"\\n                            })\\n                        })\\n                    \\n                     }\\n                }\\n                fileOutput=parts;\\n        \\t\\tvm.file=fileOutput;\\n                    \\n              }\\n             );\\n\\t} \\n\\t\\n    vm.elementNumber = function() {\\n        if(vm.myValue && vm.myValue>0 ){\\n            vm.numberRow=vm.myValue;\\n        }else{\\n            vm.numberRow=100;\\n        }\\n\\t\\t\\n \\t\\tgetEntityInfoValue();\\n    };\\n    \\n \\tfunction getEntityInfoValue() {\\n      \\n        var starTs=vm.starTs;\\n        var endTs=vm.endTs;\\n        var keys=vm.keys;\\n\\t\\tvar element=vm.numberRow;\\t\\t       \\n\\t    var dataKeysDevice=[];\\n\\n        for(let i=0; i<keys.dataKeys.length;i++){\\n            let key=keys.dataKeys[i].name;\\n            dataKeysDevice[i] = key\\n        }  \\n\\n        \\n          widgetContext.rxjs.forkJoin([\\n             \\n        //     //getEntityTimeseries(entityId: EntityId, keys: Array<string>, startTs: number, endTs: number, limit: number, agg: Aggregation Type, interval: number, orderBy: Data Sort Order, useStrictDataTypes: boolean, config?: RequestConfig): Observable<Timeseries Data>\\n        //     //export enum AggregationType {\\n        //     //   MIN = 'MIN',\\n        //     //   MAX = 'MAX',\\n        //     //   AVG = 'AVG',\\n        //     //   SUM = 'SUM',\\n        //     //   COUNT = 'COUNT',\\n        //     //   NONE = 'NONE'\\n        //     // }\\n            \\n        //     // export enum DataSortOrder {\\n        //     //     ASC = 'ASC',\\n        //     //     DESC = 'DESC'\\n        //     // }\\n             attributeService.getEntityTimeseries(entityId, dataKeysDevice, starTs, endTs, element)\\n          ]).subscribe(\\n              function (data) {\\n                   var parts = \\\"device;key; ts; value\\\\n\\\";\\n                    if(data.length > 0){\\n                     for(let i=0; i<data.length;i++){\\n                        let current=data[i];\\n                        \\n                      \\n                         Object.keys(current).forEach( key => {\\n                            current[key].forEach (element => {\\n                                 parts +=entityName+ \\\";\\\" +  key + \\\";\\\" + element.ts.toString() + \\\";\\\" + element.value + \\\"\\\\n\\\"\\n                            })\\n                        })\\n                    \\n                     }\\n                }\\n                    fileOutput=parts;\\n            \\t\\tvm.file=fileOutput;\\n             \\n              }\\n             );\\n    \\n    }\\n    \\n    vm.download=function() {\\n       downloadFile('timeseries.csv', 'data:text/csv;charset=UTF-8,' + encodeURIComponent(fileOutput));\\n   }\\n   \\n    function downloadFile(fileName, urlData) {\\n        var aLink = document.createElement('a');\\n        var evt = document.createEvent(\\\"HTMLEvents\\\");\\n        evt.initEvent(\\\"click\\\");\\n        aLink.download = fileName;\\n        aLink.href = urlData;\\n        aLink.dispatchEvent(evt);\\n        aLink.click();\\n        vm.dialogRef.close(null);\\n    } \\n    \\n        vm.save = function() {\\n        vm.addEntityFormGroup.markAsPristine();\\n        widgetContext.rxjs.forkJoin([\\n            \\n        ]).subscribe(\\n            function () {\\n                vm.dialogRef.close(null);\\n            }\\n        );\\n    };\\n\\n    vm.cancel = function() {\\n        vm.dialogRef.close(null);\\n    };\\n}\\n\",\"customResources\":[],\"openInSeparateDialog\":false,\"openInPopover\":false,\"id\":\"0336d4da-8018-df59-ebe0-b844a7d768b6\"}]},\"showTitleIcon\":false,\"iconColor\":\"rgba(0, 0, 0, 0.87)\",\"iconSize\":\"24px\",\"displayTimewindow\":true}"
    },
    "bundleAlias" : "bundle_di_test",
    "createdTime" : 1674577711143,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "23b83370-9c04-11ed-a76d-9955dd563d2d"
    },
    "tenantId" : {
      "entityType" : "TENANT",
      "id" : "64ee8810-2de8-11ed-9397-cd2dc17441ed"
    }
  } ],
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}